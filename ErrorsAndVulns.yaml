# Detection Strings are teken form FUZZDB project
# URL: https://github.com/fuzzdb-project/fuzzdb/blob/master/regex/errors.txt

# info to search signature
id: Errors-Vulns-01
info:
  name: Errors and Vulnerabilities Detection
  risk: Critical
type: fuzz

payloads:
  - '''"'
  - '`'
  - '%'
  - '\'
  - '{{"{{"}}156687*156687{{"}}"}}' 
  - '%00'
  - 'abc.txt'

requests:
  - generators:
      - Query("{{.payload}}")
    detections:
      - >-
        StringSearch("response", '&lt;/font&gt;&lt;font face="Arial" size=2&gt;') || 
        StringSearch("response", "A syntax error has occurred") || 
        StringSearch("response", "Active Server Pages error") || 
        StringSearch("response", "ADODB.Field error") || 
        StringSearch("response", "An illegal character has been found in the statement") || 
        StringSearch("response", 'An unexpected token "END-OF-STATEMENT" was found') || 
        StringSearch("response", "ASP.NET is configured to show verbose error messages") || 
        StringSearch("response", "ASP.NET_SessionId") || 
        StringSearch("response", "Can't connect to local") || 
        StringSearch("response", "CLI Driver") || 
        StringSearch("response", "Custom Error Message") || 
        StringSearch("response", "data source=") ||
        StringSearch("response", "database error") || 
        StringSearch("response", "DB2 Driver") || 
        StringSearch("response", "DB2 Error") || 
        StringSearch("response", "DB2 ODBC") || 
        StringSearch("response", "detected an internal error") || 
        StringSearch("response", "detected an internal error [IBM][CLI Driver][DB2/6000]") || 
        StringSearch("response", "Died at") || 
        StringSearch("response", "Disallowed Parent Path") || 
        StringSearch("response", "error") || 
        StringSearch("response", "Error converting data type varchar to numeric") || 
        StringSearch("response", "Error Diagnostic Information") || 
        StringSearch("response", "Error Message : Error loading required libraries.") || 
        StringSearch("response", "Error Report") || 
        StringSearch("response", "Fatal error") || 
        StringSearch("response", "include_path") || 
        StringSearch("response", "Incorrect syntax near") || 
        StringSearch("response", "Index of") || 
        StringSearch("response", "Internal Server Error") || 
        StringSearch("response", "Invalid Path Character") || 
        StringSearch("response", "Invalid procedure call or argument") || 
        StringSearch("response", "invalid query") || 
        StringSearch("response", "Invision Power Board Database Error") || 
        StringSearch("response", "is not allowed to access") || 
        StringSearch("response", "JDBC Driver") || 
        StringSearch("response", "JDBC Error") || 
        StringSearch("response", "JDBC MySQL") || 
        StringSearch("response", "JDBC Oracle") || 
        StringSearch("response", "JDBC SQL") || 
        StringSearch("response", "Microsoft OLE DB Provider for ODBC Drivers") || 
        StringSearch("response", "Microsoft VBScript compilation error") || 
        StringSearch("response", "Microsoft VBScript error") || 
        StringSearch("response", "missing expression") || 
        StringSearch("response", "mix of collations") || 
        StringSearch("response", "MySQL Driver") || 
        StringSearch("response", "mysql error") || 
        StringSearch("response", "MySQL Error") || 
        StringSearch("response", "mySQL error with query") || 
        StringSearch("response", "MySQL ODBC") || 
        StringSearch("response", "ODBC DB2") || 
        StringSearch("response", "ODBC Driver") || 
        StringSearch("response", "ODBC Error") || 
        StringSearch("response", "ODBC Microsoft Access") || 
        StringSearch("response", "ODBC Oracle") || 
        StringSearch("response", "ODBC SQL") || 
        StringSearch("response", "ODBC SQL Server") || 
        StringSearch("response", "OLE/DB provider returned message") || 
        StringSearch("response", "on line") || 
        StringSearch("response", "on MySQL result index") || 
        StringSearch("response", "ORA-0") || 
        StringSearch("response", "ORA-1") || 
        StringSearch("response", "Oracle DB2") || 
        StringSearch("response", "Oracle Driver") || 
        StringSearch("response", "Oracle Error") || 
        StringSearch("response", "Oracle ODBC") || 
        StringSearch("response", "Parent Directory") || 
        StringSearch("response", "Permission denied: 'GetObject'") || 
        StringSearch("response", "PHP Error") || 
        StringSearch("response", "PHP Parse error") || 
        StringSearch("response", "PHP Warning") || 
        StringSearch("response", "PostgreSQL query failed: ERROR: parser: parse error") || 
        StringSearch("response", "server at") || 
        StringSearch("response", "server object error") || 
        StringSearch("response", "SQL command not properly ended") || 
        StringSearch("response", "SQL Server Driver") || 
        StringSearch("response", "SQL Server Driver][SQL Server") || 
        StringSearch("response", "SQLException") || 
        StringSearch("response", "supplied argument is not a valid MySQL result resource") || 
        StringSearch("response", "Supplied argument is not a valid PostgreSQL result") || 
        StringSearch("response", "Syntax error in query expression") || 
        StringSearch("response", "The error occurred in") || 
        StringSearch("response", "The script whose uid is") || 
        StringSearch("response", "Type mismatch") || 
        StringSearch("response", "Unable to jump to row") || 
        StringSearch("response", "Unclosed quotation mark before the character string") || 
        StringSearch("response", "unexpected end of SQL command") || 
        StringSearch("response", "unexpected error") || 
        StringSearch("response", "Unterminated string constant") || 
        StringSearch("response", "Warning: Cannot modify header information - headers already sent") || 
        StringSearch("response", "Warning: mysql_query") || 
        StringSearch("response", "Warning: mysql_query()") || 
        StringSearch("response", "Warning: pg_connect") || 
        StringSearch("response", "Warning: pg_connect(): Unable to connect to PostgreSQL server: FATAL") || 
        StringSearch("response", "Warning: Supplied argument is not a valid File-Handle resource in") || 
        StringSearch("response", "You have an error in your SQL syntax near") ||
        StringSearch("response", "313374")

